
kernel void scatter(const int Nscatter,
		   const int * restrict scatterStarts,
		   const int * restrict scatterIds,
		   const dfloat * restrict q,
		   dfloat * restrict scatterq){

  for(int s=0;s<Nscatter;++s;tile(256)){

    if(s<Nscatter){
      const dfloat qs = q[s];
      
      const int start = scatterStarts[s];
      const int end = scatterStarts[s+1];
      
      for(int n=start;n<end;++n){
      	const int id =	scatterIds[n];
      	scatterq[id] = qs;
      }
    }
  }
}

