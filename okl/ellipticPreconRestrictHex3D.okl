

@kernel void ellipticFooHex3D(int Nelements,
           dfloat * Pq,
           dfloat * Rq){
  

  for(int e=0;e<Nelements;++e;@outer(0)){
    for(int k=0;k<p_Nq;++k;@inner(2)){
      for(int j=0;j<p_Nq;++j;@inner(1)){
        for(int i=0;i<p_Nq;++i;@inner(0)){
          int idP = (i+1) + (p_NqP*(j+1)) + (p_NqP*p_NqP*(k+1)) + e*(p_NpP);
          int id  = i   + p_Nq*j      + p_Nq*p_Nq*k       + e*p_Np;
          Rq[id] = Pq[idP];
          //    Rq[id] = 1;
        }
      }
    }
  }
}
