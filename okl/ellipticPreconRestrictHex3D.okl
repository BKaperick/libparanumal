

kernel void ellipticFooHex3D(iint Nelements,
			     dfloat * Pq,
			     dfloat * Rq){
  

  for(iint e=0;e<Nelements;++e;outer0){
    for(iint k=0;k<p_Nq;++k;inner2){
      for(iint j=0;j<p_Nq;++j;inner1){
	for(iint i=0;i<p_Nq;++i;inner0){
	  iint idP = (i+1) + (p_NqP*(j+1)) + (p_NqP*p_NqP*(k+1)) + e*(p_NpP);
	  iint id  = i   + p_Nq*j      + p_Nq*p_Nq*k       + e*p_Np;
	  Rq[id] = Pq[idP];
	  //	  Rq[id] = 1;
	}
      }
    }
  }
}
