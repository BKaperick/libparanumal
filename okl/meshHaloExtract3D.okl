
kernel void meshHaloExtract3D(const int NhaloElements,
			      const int Nentries,
			      const int   * restrict haloElements,
			      const dfloat * restrict q,
			            dfloat * restrict haloq){

  for(int e=0;e<NhaloElements;++e;outer0){  // for all elements
    for(int n=0;n<Nentries;++n;inner0){     // for all entries in this element
      const int id = haloElements[e];
      haloq[n + Nentries*e] = q[n + Nentries*id];
    }
  }
}
