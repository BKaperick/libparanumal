
@kernel void acousticsPmlUpdate2D(const int Ntotal,
				     const dfloat dt,	
				     const dfloat rka,
				     const dfloat rkb,
				     @restrict const  dfloat *  pmlrhsq,
				     @restrict dfloat *  pmlresq,
				     @restrict dfloat *  pmlq){
    
  // Low storage Runge Kutta time step update
  for(int n=0;n<Ntotal;++n;@tile(256,@outer,@inner)){
    if(n<Ntotal){
      dfloat pmlresqn = pmlresq[n];
      pmlresqn = rka*pmlresqn + dt*pmlrhsq[n];
      pmlresq[n] = pmlresqn;
      pmlq[n] += rkb*pmlresqn;
    }
  }
}

