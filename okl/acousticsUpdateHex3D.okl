
@kernel void acousticsUpdateHex3D(const int Ntotal,
				  const dfloat dt,	
				  const dfloat rka,
				  const dfloat rkb,
				  @restrict const  dfloat *  rhsq,
				  @restrict dfloat *  resq,
				  @restrict dfloat *  q){
				  
  // Low storage Runge Kutta time step update
  for(int n=0;n<Ntotal;++n;@tile(256,@outer,@inner)){
    if(n<Ntotal){
      dfloat resqn = resq[n];
      resqn = rka*resqn + dt*rhsq[n];
      resq[n] = resqn;
      q[n] += rkb*resqn;
    }
  }
}
